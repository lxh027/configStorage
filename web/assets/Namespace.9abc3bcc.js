import{s as e}from"./index.d0a782d5.js";import{a}from"./cluster.0aebc448.js";import{f as l,B as t,A as d,p as o,b as n,L as r,C as s,r as u,o as i,c,g as p,h as m,t as f,m as _,F as h,j as y,w as b}from"./vendor.971a53c8.js";const g={name:"namespace",setup(){const o=l(),n=t({name:"",pageIndex:1,pageSize:10}),u=d([]),i=d(0),c=()=>{(a=>e({url:"/namespace/getUserNamespaces",method:"post",data:a}))(n).then((e=>{u.value=e.data.namespaces,i.value=e.data.count||50}))};c();const p=d(!1);let m=t({name:"",raft_id:""});const f=d([]),_=()=>{a(n).then((e=>{f.value=[];for(let a=0;a<e.data.cluster.length;a++)f.value.push(e.data.cluster[a])}))};_();const h=d(!1);let y=t({username:"",auth:"",namespace_id:""});const b=d(!1);let g=t({raft_id:"",namespace_id:0});return{query:n,tableData:u,pageTotal:i,handleSearch:()=>{n.pageIndex=1,c()},handlePageChange:e=>{n.pageIndex=e,c()},goConfig:(e,a)=>{o.push({name:"config",query:{id:e,namespace:a}})},addVisible:p,form:m,options:f,handleAdd:()=>{_(),p.value=!0},addNamespace:()=>{r.confirm("确定要添加吗？","提示",{type:"warning"}).then((()=>{(a=>e({url:"/namespace/newNamespace",method:"post",data:a}))({name:m.name,raft_id:m.raft_id}).then((e=>{0===e.status?(s.success("添加成功"),c(),p.value=!1):s.error("添加失败")}))})).catch((()=>{}))},goCluster:e=>{o.push({name:"monitor",query:{raft_id:e}})},setAuthVisible:h,form2:y,setNamespaceAuth:()=>{r.confirm("确定要设置吗？","提示",{type:"warning"}).then((()=>{(a=>e({url:"/namespace/setAuth",method:"post",data:a}))({namespace_id:y.namespace_id,username:y.username,type:y.auth}).then((e=>{0===e.status?(s.success("设置成功"),c(),p.value=!1):s.error("设置失败")}))})).catch((()=>{}))},setAuth:e=>{y.username="",y.auth="",y.namespace_id=e,h.value=!0},deleteNamespace:a=>{r.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{(a=>e({url:"/namespace/deleteNamespace",method:"post",data:a}))({namespace_id:a}).then((e=>{0===e.status?(s.success("删除成功"),c()):s.error("删除失败")}))}))},form3:g,setCluster:(e,a)=>{_(),g.raft_id=a,g.namespace_id=e,b.value=!0},changeCluster:()=>{(a=>e({url:"/namespace/updateRaftID",method:"post",data:a}))(g).then((e=>{0===e.status?(s.success("更新成功"),c(),b.value=!1):s.error("更新失败")}))},setClusterVisible:b}}},C=b();o("data-v-66dcbe94");const k={class:"crumbs"},V=p("i",{class:"el-icon-lx-cascades"},null,-1),w=m(" 命名空间 "),v={class:"container"},x={class:"handle-box"},A=m("搜索"),N=m("新增"),U={key:0},z={key:1},I={key:2},q=m("设置权限"),D=m("设置权限"),j=m("更改集群位置"),R=m("更改集群位置"),S=m("删除"),T=m("删除"),B={class:"pagination"},P={style:{float:"left"}},F={style:{float:"right",color:"#8492a6","font-size":"13px"}},L={class:"dialog-footer"},O=m("取 消"),E=m("确 定"),G={style:{float:"left"}},H={style:{float:"right",color:"#8492a6","font-size":"13px"}},J={class:"dialog-footer"},K=m("取 消"),M=m("确 定"),Q=m("Normal"),W=m("Readonly"),X=m("Banned"),Y={class:"dialog-footer"},Z=m("取 消"),$=m("确 定");n();const ee=C(((e,a,l,t,d,o)=>{const n=u("el-breadcrumb-item"),r=u("el-breadcrumb"),s=u("el-input"),b=u("el-button"),g=u("el-table-column"),ee=u("el-tag"),ae=u("el-table"),le=u("el-pagination"),te=u("el-form-item"),de=u("el-option"),oe=u("el-select"),ne=u("el-form"),re=u("el-dialog");return i(),c("div",null,[p("div",k,[p(r,{separator:"/"},{default:C((()=>[p(n,null,{default:C((()=>[V,w])),_:1})])),_:1})]),p("div",v,[p("div",x,[p(s,{modelValue:t.query.name,"onUpdate:modelValue":a[1]||(a[1]=e=>t.query.name=e),placeholder:"命名空间",class:"handle-input mr10"},null,8,["modelValue"]),p(b,{type:"primary",icon:"el-icon-search",onClick:t.handleSearch},{default:C((()=>[A])),_:1},8,["onClick"]),p(b,{type:"primary",icon:"el-icon-plus",onClick:t.handleAdd},{default:C((()=>[N])),_:1},8,["onClick"])]),p(ae,{data:t.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:C((()=>[p(g,{prop:"id",label:"ID",width:"55",align:"center"}),p(g,{prop:"name",label:"命名空间"},{default:C((e=>[p(b,{size:"medium",round:"",onClick:a=>t.goConfig(e.row.id,e.row.name)},{default:C((()=>[m(f(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),p(g,{prop:"username",label:"所有者"}),p(g,{prop:"raft_id",label:"集群ID"},{default:C((e=>[p(b,{size:"medium",round:"",onClick:a=>t.goCluster(e.row.raft_id)},{default:C((()=>[m(f(e.row.raft_id),1)])),_:2},1032,["onClick"])])),_:1}),p(g,{prop:"private_key",label:"密钥"}),p(g,{label:"状态",align:"center"},{default:C((e=>[p(ee,{effect:"dark",type:0===e.row.type?"success":1===e.row.type?"warning":2===e.row.type?"danger":"info"},{default:C((()=>[0===e.row.type?(i(),c("p",U," Owner ")):1===e.row.type?(i(),c("p",z," Normal ")):2===e.row.type?(i(),c("p",I," Readonly ")):_("",!0)])),_:2},1032,["type"])])),_:1}),p(g,{label:"操作",align:"center"},{default:C((e=>[0===e.row.type?(i(),c(b,{key:0,type:"text",icon:"el-icon-s-grid",onClick:a=>t.setAuth(e.row.id)},{default:C((()=>[q])),_:2},1032,["onClick"])):(i(),c(b,{key:1,disabled:"",type:"text",icon:"el-icon-s-grid"},{default:C((()=>[D])),_:1})),0===e.row.type?(i(),c(b,{key:2,type:"text",icon:"el-icon-s-grid",onClick:a=>t.setCluster(e.row.id,e.row.raft_id)},{default:C((()=>[j])),_:2},1032,["onClick"])):(i(),c(b,{key:3,disabled:"",type:"text",icon:"el-icon-s-grid"},{default:C((()=>[R])),_:1})),0===e.row.type?(i(),c(b,{key:4,type:"text",icon:"el-icon-s-grid",class:"red",onClick:a=>t.deleteNamespace(e.row.id)},{default:C((()=>[S])),_:2},1032,["onClick"])):(i(),c(b,{key:5,disabled:"",type:"text",icon:"el-icon-s-grid"},{default:C((()=>[T])),_:1}))])),_:1})])),_:1},8,["data"]),p("div",B,[p(le,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),p(re,{title:"新建命名空间",modelValue:t.addVisible,"onUpdate:modelValue":a[5]||(a[5]=e=>t.addVisible=e),width:"30%"},{footer:C((()=>[p("span",L,[p(b,{onClick:a[4]||(a[4]=e=>t.addVisible=!1)},{default:C((()=>[O])),_:1}),p(b,{type:"primary",onClick:t.addNamespace},{default:C((()=>[E])),_:1},8,["onClick"])])])),default:C((()=>[p(ne,{"label-width":"70px"},{default:C((()=>[p(te,{label:"命名"},{default:C((()=>[p(s,{modelValue:t.form.name,"onUpdate:modelValue":a[2]||(a[2]=e=>t.form.name=e)},null,8,["modelValue"])])),_:1}),p(te,{label:"集群"},{default:C((()=>[p(oe,{modelValue:t.form.raft_id,"onUpdate:modelValue":a[3]||(a[3]=e=>t.form.raft_id=e),placeholder:"请选择"},{default:C((()=>[(i(!0),c(h,null,y(t.options,(e=>(i(),c(de,{key:e.raft_id,label:e.raft_id,value:e.raft_id},{default:C((()=>[p("span",P,f(e.raft_id),1),p("span",F,f(e.address),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),p(re,{title:"更改集群",modelValue:t.setClusterVisible,"onUpdate:modelValue":a[9]||(a[9]=e=>t.setClusterVisible=e),width:"30%"},{footer:C((()=>[p("span",J,[p(b,{onClick:a[7]||(a[7]=e=>t.setClusterVisible=!1)},{default:C((()=>[K])),_:1}),p(b,{type:"primary",onClick:a[8]||(a[8]=e=>t.changeCluster())},{default:C((()=>[M])),_:1})])])),default:C((()=>[p(ne,{"label-width":"70px"},{default:C((()=>[p(te,{label:"集群"},{default:C((()=>[p(oe,{modelValue:t.form3.raft_id,"onUpdate:modelValue":a[6]||(a[6]=e=>t.form3.raft_id=e),placeholder:"请选择"},{default:C((()=>[(i(!0),c(h,null,y(t.options,(e=>(i(),c(de,{key:e.raft_id,label:e.raft_id,value:e.raft_id},{default:C((()=>[p("span",G,f(e.raft_id),1),p("span",H,f(e.address),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),p(re,{title:"设置权限",modelValue:t.setAuthVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>t.setAuthVisible=e),width:"30%"},{footer:C((()=>[p("span",Y,[p(b,{onClick:a[12]||(a[12]=e=>t.setAuthVisible=!1)},{default:C((()=>[Z])),_:1}),p(b,{type:"primary",onClick:t.setNamespaceAuth},{default:C((()=>[$])),_:1},8,["onClick"])])])),default:C((()=>[p(ne,{"label-width":"70px"},{default:C((()=>[p(te,{label:"用户名"},{default:C((()=>[p(s,{modelValue:t.form2.username,"onUpdate:modelValue":a[10]||(a[10]=e=>t.form2.username=e)},null,8,["modelValue"])])),_:1}),p(te,{label:"权限"},{default:C((()=>[p(oe,{modelValue:t.form2.auth,"onUpdate:modelValue":a[11]||(a[11]=e=>t.form2.auth=e),placeholder:"请选择"},{default:C((()=>[p(de,{label:"Normal",value:1,key:"1"},{default:C((()=>[p(ee,{type:"warning"},{default:C((()=>[Q])),_:1})])),_:1}),p(de,{label:"Readonly",value:2,key:"2"},{default:C((()=>[p(ee,{type:"danger"},{default:C((()=>[W])),_:1})])),_:1}),p(de,{label:"Abandon",value:-1,key:"-1"},{default:C((()=>[p(ee,{type:"info"},{default:C((()=>[X])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}));g.render=ee,g.__scopeId="data-v-66dcbe94";export default g;
